---
title: "RSV"
author: "PS_2021_008"
date: "2025-12-26"
output: word_document
---

```{r}
# Install packages 
#install.packages(c("readxl", "forecast", "tseries", "ggplot2"))

```
```{r}
# Load packages
library(readxl)
library(forecast)
library(tseries)
library(ggplot2)

```
```{r}
data <- read_excel("Monetary_transmission_data_I.xlsx")
```
```{r}
#for additional check 
head(data)
```
```{r}
#column names
colnames(data)
```
```{r}
RSV <- ts(data$RSV,
          start = c(2006, 1),
          frequency = 12)

```
```{r}
ggplot(data, aes(x = DATE, y = RSV)) +
  geom_line(color = "blue") +
  geom_point(color = "red", size = 1) +
  geom_smooth(method = "loess", se = FALSE, color = "darkgreen") +
  labs(title = "Time Series Plot of RSV",
       x = "Time",
       y = "RSV") +
  theme_minimal()

```
```{r}
#stationary tests(RSV-Level)
adf.test(RSV)
pp.test(RSV)
kpss.test(RSV)

#output
#The stationarity of the RSV series was examined using the Augmented Dickey–Fuller (ADF), Phillips–Perron (PP), and KPSS tests. The ADF and PP tests failed to reject the null hypothesis of a unit root, while the KPSS test rejected the null hypothesis of level stationarity. These results consistently indicate that the RSV series is non-stationary in levels.
#Decision rule (ADF):
     #H₀: Series has a unit root (non-stationary)
     #p-value > 0.05 → Fail to reject H₀
#Decision rule (PP):
     #H₀: Unit root (non-stationary)
     #p-value > 0.05 → Fail to reject H₀
#Decision rule (KPSS):
     #H₀: Series is stationary
     #p-value < 0.05 → Reject H₀
#CONCLUSION-> RSV is non-stationary → transformation needed
```
```{r}
#Log Transformation of RSV
log_RSV <- log(RSV)

plot(log_RSV,
     main = "Log-transformed RSV",
     ylab = "log(RSV)",
     xlab = "Time")

```
```{r}
#Differencing(Trend + Seasonality)
  #First Difference (Trend)
diff_RSV <- diff(log_RSV)
```
```{r}
#Seasonal Difference(Monthly)

diff_seasonal_RSV <- diff(diff_RSV, lag = 12)
```
```{r}
#Plot Differenced Series
plot(diff_seasonal_RSV,
     main = "Differenced RSV (Log + Trend + Seasonal)",
     ylab = "Δlog(RSV)",
     xlab = "Time")
```
```{r}
#Stationarity Tests (After Differencing)
adf.test(diff_seasonal_RSV)
kpss.test(diff_seasonal_RSV)

```
```{r}
#ACF & PACF Plots
acf(diff_seasonal_RSV,
    main = "ACF of Stationary RSV")

pacf(diff_seasonal_RSV,
     main = "PACF of Stationary RSV")

#output explanation 
#The ACF and PACF analysis suggests that your time series has both non-seasonal and seasonal components. For the non-seasonal part, the ACF shows a significant positive spike at Lag 1 that quickly diminishes, indicating a potential MA(1) component, while the PACF shows significant spikes at Lags 1–3, pointing to an AR(2) or AR(3) structure. For the seasonal part, both ACF and PACF exhibit a prominent negative spike at the seasonal lag (likely Lag 12 for monthly data), indicating a strong seasonal effect that may require a Seasonal Moving Average (SMA) term and careful model tuning. Overall, the series appears to have a combination of short-term autoregressive behavior and pronounced seasonality.
```
```{r}
#SARIMA Model Using Auto ARIMA
auto_model_RSV <- auto.arima(log_RSV,
                             seasonal = TRUE,
                             stepwise = FALSE,
                             approximation = FALSE)

summary(auto_model_RSV)

```
```{r}
#Residual Diagnostics-(optional work)
checkresiduals(auto_model_RSV)

```

